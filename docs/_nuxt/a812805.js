(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{525:function(t,e){t.exports={e18:BigInt(1+"0".repeat(18)),e36:BigInt(1+"0".repeat(36)),e34:BigInt(1+"0".repeat(34)),e14:BigInt(1+"0".repeat(14)),floatEtherToWei:t=>BigInt(Math.round(1e10*t))*BigInt(1e8)}},530:function(t,e,l){var content=l(538);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,l(62).default)("bf1671ae",content,!0,{sourceMap:!1})},537:function(t,e,l){"use strict";l(530)},538:function(t,e,l){var r=l(61)(!1);r.push([t.i,".inputgroup-div[data-v-2cba8a47]{border:1px!important;width:1%;min-width:0;flex:1 1 auto}.inputgroup-end[data-v-2cba8a47]{border:1px!important;flex:0 0 auto;border-radius:1px}.inputgroup-div>input[data-v-2cba8a47]{border-radius:0;margin-bottom:0;border-right:0}.slider[data-v-2cba8a47]{-webkit-appearance:none;max-width:100%;width:50%;height:15px;border-radius:5px;background:#d3d3d3;outline:none;opacity:.7;transition:opacity .2s}.slider[data-v-2cba8a47]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:25px;height:25px;border-radius:50%;background:#04aa6d;cursor:pointer}.slider[data-v-2cba8a47]::-moz-range-thumb{width:25px;height:25px;border-radius:50%;background:#04aa6d;cursor:pointer}",""]),t.exports=r},545:function(t,e,l){"use strict";l.r(e);l(534),l(535);var r=l(525),n=l.n(r),o={computed:{nativeCurrency(){return this.$store.getters["web3/network"].symbol},currentAccount(){return this.$store.state.web3.accounts},tokenAddress(){return this.$route.query.address.toLowerCase()},decimalBalance(){return this.toRounded(this.balance)},decimalCirulation(){return console.log("Circulating",this.circulating),this.toRounded(this.circulating)},decimalMaxSupply(){return this.toRounded(this.maxSupply)},saleAmountDecimal(){return parseFloat(BigInt(this.lastSale.amount)/n.a.e14)/1e4},floatFee(){return parseFloat(this.saleCreatefee/n.a.e14)/1e4},postSaleBurn:{get(){return!this.sale.remainingTokensRefunded},set(t){this.sale.remainingTokensRefunded=!t}}},methods:{onSliderChange(t){console.log("inputparam",t),this.sale.liquidityPercent=t},showError(t,title){this.$bvToast.toast(t.message||t,{title:title||"Unexpected Error ",variant:"danger",solid:!0})},logAndReturn:(t,e)=>(console.log(e,t),t),navigateToLastSale(){},toRounded(t){return console.log("Rounding val to ",t,this.decimals),this.decimals?t&&BigInt(t)/BigInt(Math.pow(10,this.decimals)):t},createSale(){this.sale.metamaskStarted=!0;const t=[],e=this.sale;let l,r=parseFloat(this.sale.rate),o=parseFloat(this.sale.hardCap),c=parseFloat(this.sale.softCap);r?r=n.a.floatEtherToWei(r)*BigInt(Math.pow(10,this.decimals)):t.push("Invalid value for rate : "+e.rate),o?o=n.a.floatEtherToWei(o):t.push("Invalid value for Hard Cap : "+e.hardCap),c?c=n.a.floatEtherToWei(c):t.push("Invalid value for Goal :"+e.softCap);const d=new Date(e.endDate+(e.endTime?" "+e.endTime:""));if(d||t.push("Invalid value for endDate :"+e.endDate+" "+e.endTime),e.startImmediately||(e.startDate?(l=new Date(e.startDate+(e.startTime?" "+e.startTime:"")),l||t.push("Invalid value for startDate : "+e.startDate+" "+e.startTime)):t.push("Missing startDate when tokensale is not set to start immediately")),e.endDate?d.getTime()-Date.now()<0&&t.push("EndTime before Start Time"):t.push("Missing End Date"),t.length)console.log("Error creating tokensale",t),this.showErrorToast(t),this.sale.metamaskStarted=!1;else{const t=l&&Math.round(l.getTime()/1e3),e=Math.round(d.getTime()/1e3);console.log(this.sale);let m=c*BigInt(this.sale.liquidityPercent)/BigInt(100),h=m*r/n.a.e36;console.log("liquidityTokens",h,"liquidityEth",m);const v=this.$web3.deployTokenSale(this.$route.query.address,this.$store.state.web3.accounts[0],r,c,o,h,m,t,e);console.log("deployTokensaale()",this.$route.query.address,this.$store.state.web3.accounts[0],r,c,o,h,m,t,e),v.send({value:BigInt(this.saleCreatefee).toString(10)}).on("transactionHash",(t=>{const e=this.$createElement;this.$bvToast.toast([e("p",{},"Submitted tx:"+t.substr(0,10)+"...")],{title:"Tx Submitted",variant:"info",solid:!0}),this.sale.progress="Tx Submitted, Waiting for confirmation"})).on("receipt",(t=>{const e=t.events.TokenSaleCreated.returnValues.saleContract;this.$bvToast.toast("Contract deployed : "+e,{title:"Tokensale Creation",variant:"success",solid:!0})})).then((()=>{this.sale.metamaskStarted=!1,this.sale.progress=void 0,this.getPageData()})).catch((t=>{this.sale.metamaskStarted=!1,this.sale.progress=void 0,this.$bvToast.toast(t.message,{title:"There was error creating tokensale",variant:"danger",solid:!0})}))}},watchToken(){return this.$web3.requestWatchToken(this.tokenAddress,this.symbol,this.decimals,"http://placekitten.com/200/300'").then((()=>{console.log("Token registered to the wallet",this.tokenAddress)}))},getPageData(){console.log("Getting page data");const t=this.$web3.bep20Instance(this.tokenAddress).methods;return Promise.allSettled([this.$web3.contracts.tokenSaleRegistry().methods.saleStatus(this.tokenAddress).call(),t.info().call(),this.$web3.contracts.tokenRegistry().methods.wasCreated(this.tokenAddress).call()]).then((([t,e,l])=>{if(console.log("Wascreated",l),"fulfilled"!==l.status)throw Error("Cannot determine contract information from registry");if(!l.value)throw Error("Contract is not registred in the registry");if("fulfilled"!==t.status)throw t.error;{const e=t.value,l=this.lastSale;[this.saleCreatefee,l.exists,l.isOpen,l.isClosed,l.address,l.amount]=[BigInt(e[0]),e[1],e[2],e[3],e[4],e[5]]}if("fulfilled"!==e.status)throw info.error;[this.name,this.symbol,this.decimals,this.circulating,this.balance,this.maxSupply,this.burnable,this.mintable]=[0,1,2,3,4,5,6,7].map((i=>e.value[i])),console.log("Token Details",{name:this.name,symbol:this.symbol,totalSupply:this.circulating,decimals:this.decimals,cap:this.maxSupply,userBalance:this.userBalance,burnable:this.burnable,mintable:this.mintable})})).catch((t=>console.error(t)))},showErrorToast(t,title=""){const e=this.$createElement,body=t.map((t=>e("p",{},t)));console.log(body),this.$bvToast.toast(body,{title:title||"Error",solid:!0,variant:"danger"})}},created(){return Promise.resolve(this.getPageData())},watch:{currentAccount(t,e){this.getPageData()}},data:()=>({ciritical_available_data:0,name:null,symbol:null,owner:null,circulating:null,maxSupply:null,decimals:null,balance:null,contract:null,burnable:!1,mintable:!1,sale:{startImmediately:!0,rate:void 0,hardCap:void 0,softCap:void 0,startTime:void 0,startDate:void 0,endTime:void 0,endDate:void 0,address:null,errors:[],remainingTokenAction:"burn",liquidityPercent:50,progress:void 0,metamaskStarted:!1},lastSale:{exists:!1,isOpen:!1,isClosed:!1,address:"",amount:0},saleCreatefee:BigInt(0)})},c=(l(537),l(35)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("form",{staticClass:"container container-fluid",on:{submit:function(e){e.preventDefault(),t.createSale()}}},[l("div",{staticClass:"row"},[l("div",{staticClass:"col"},[l("span",[l("span",{staticClass:"h1"},[t._v(t._s(t.name)+" ("+t._s(t.symbol)+")")]),l("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"float-right mt-2",attrs:{variant:"outline-info",type:"button",title:"Add Token to Asset List"},on:{click:t.watchToken}},[l("b-icon-eye",{attrs:{variant:"danger"}})],1)],1),t._v(" "),l("h3",[t._v("Circulating Supply :"+t._s(t.decimalCirulation))]),t._v(" "),t.maxSupply&&t.maxSupply>0?l("h3",[t._v("Max Supply: "+t._s(t.decimalMaxSupply))]):t._e(),t._v(" "),l("h3",[t._v("Balance : "+t._s(t.decimalBalance))])])]),t._v(" "),t.lastSale&&t.lastSale.exists?l("div",{staticClass:"row"},[l("div",{staticClass:"col text-center pb-2"},[l("div",{staticClass:"align-self-center border-info"},[l("span",{staticClass:"text-info  text-lg mr-3"},[t._v("\n        "+t._s(t.lastSale.isOpen?"Token Sale for "+t.saleAmountDecimal+" "+t.$web3.symbol()+" is  (Live)":t.lastSale.isClosed?"Last Token Sale has finished":"Upcoming Sale of "+t.lastSale.amount+" "+t.symbol)+"\n        ")]),t._v(" "),l("NuxtLink",{attrs:{to:"/tokensale?address="+this.lastSale.address}},[l("div",{staticClass:"btn btn-outline-info"},[t._v("\n              Visit Tokensale\n            ")])])],1)])]):t._e(),t._v(" "),t._m(0),t._v(" "),l("div",{staticClass:"row  justify-content-center "},[l("div",{staticClass:"col col-xl-7 col-lg-8 col-md-10 col-sm-11 text-center mt-3"},[l("div",{staticClass:"container"},[l("div",{staticClass:"row"},[l("b-input-group",{staticClass:"col text-center"},[l("b-input-group-prepend",{staticClass:"col-3 input-group-text"},[t._v("\n                Rate\n              ")]),t._v(" "),l("b-input",{staticClass:"text-right",attrs:{required:"",placeholder:t.nativeCurrency+" - "+t.symbol},model:{value:t.sale.rate,callback:function(e){t.$set(t.sale,"rate",e)},expression:"sale.rate"}})],1)],1),t._v(" "),l("div",{staticClass:"row"},[l("b-input-group",{staticClass:"mt-2 col"},[l("b-input-group-prepend",{staticClass:"col-3 input-group-text text-center"},[t._v("\n                Goal\n              ")]),t._v(" "),l("b-form-input",{staticClass:"text-right",attrs:{required:"",max:t.balance,placeholder:t.nativeCurrency},model:{value:t.sale.softCap,callback:function(e){t.$set(t.sale,"softCap",e)},expression:"sale.softCap"}}),t._v(" "),l("b-input-group-append")],1)],1),t._v(" "),l("div",{staticClass:"row"},[l("b-input-group",{staticClass:"mt-2 col"},[l("b-input-group-prepend",{staticClass:"col-3 input-group-text text-center"},[t._v("\n                Presale Amount\n              ")]),t._v(" "),l("b-form-input",{staticClass:"text-right",attrs:{required:"",max:t.balance,placeholder:t.nativeCurrency},model:{value:t.sale.hardCap,callback:function(e){t.$set(t.sale,"hardCap",e)},expression:"sale.hardCap"}})],1)],1),t._v(" "),l("div",{staticClass:"row"},[l("div",{staticClass:"col text-left text-muted mt-1"},[t.burnable?l("div",{staticClass:"text-muted text"},[l("div",[t._v("What shold be done with remaining token?")]),t._v(" "),l("b-form-radio",{attrs:{name:"post-sale",checked:"checked",value:"burn"},model:{value:t.sale.remainingTokenAction,callback:function(e){t.$set(t.sale,"remainingTokenAction",e)},expression:"sale.remainingTokenAction"}},[t._v(" Burn")]),t._v(" "),l("b-form-radio",{attrs:{name:"post-sale",value:"reclaim"},model:{value:t.sale.remainingTokenAction,callback:function(e){t.$set(t.sale,"remainingTokenAction",e)},expression:"sale.remainingTokenAction"}},[t._v(" Reclaim")])],1):l("div",[l("strong",[t._v(" Unsold tokens will be returned to you.")])])])]),t._v(" "),l("div",{staticClass:"row"},[l("div",{staticClass:"col mt-4 text-left"},[l("b-checkbox",{model:{value:t.sale.startImmediately,callback:function(e){t.$set(t.sale,"startImmediately",e)},expression:"sale.startImmediately"}},[t._v(" Start Immediately")])],1)]),t._v(" "),l("div",{staticClass:"row"},[l("b-input-group",{staticClass:"col mt-1"},[l("b-input-group-prepend",{staticClass:"col-3 input-group-text text-center"},[t._v("\n                Start At\n              ")]),t._v(" "),l("b-form-datepicker",{attrs:{placeholder:"immediately",disabled:t.sale.startImmediately},model:{value:t.sale.startDate,callback:function(e){t.$set(t.sale,"startDate",e)},expression:"sale.startDate"}}),t._v(" "),l("b-form-timepicker",{attrs:{placeholder:"-",disabled:t.sale.startImmediately},model:{value:t.sale.startTime,callback:function(e){t.$set(t.sale,"startTime",e)},expression:"sale.startTime"}})],1)],1),t._v(" "),l("div",{staticClass:"row"},[l("b-input-group",{staticClass:"mt-2 col"},[l("b-input-group-prepend",{staticClass:"col-3 input-group-text text-center"},[t._v("\n                End At\n              ")]),t._v(" "),l("b-form-datepicker",{attrs:{required:"required"},model:{value:t.sale.endDate,callback:function(e){t.$set(t.sale,"endDate",e)},expression:"sale.endDate"}}),t._v(" "),l("b-form-timepicker",{attrs:{required:"required"},model:{value:t.sale.endTime,callback:function(e){t.$set(t.sale,"endTime",e)},expression:"sale.endTime"}})],1)],1),t._v(" "),l("div",{staticClass:"row"},[l("div",{staticClass:"col"},[l("label",{attrs:{for:"my-slider"}},[t._v(" Liquidity ")]),t._v(" "),l("b-input-group",[l("b-input-group-prepend",{staticClass:"col-3 input-group-text text-center"},[t._v("\n                  Liquidity (%)\n                ")]),t._v(" "),l("b-form-input",{attrs:{type:"range",id:"my-slider",min:"60",max:"100"},model:{value:t.sale.liquidityPercent,callback:function(e){t.$set(t.sale,"liquidityPercent",e)},expression:"sale.liquidityPercent"}}),t._v(" "),l("b-input-group-append",{staticStyle:{"vertical-align":"baseline"}},[l("b-form-input",{staticClass:"ml-2",staticStyle:{"max-width":"10em",width:"5em"},attrs:{maxlength:"5",type:"number",min:"50",max:"100",id:"slider-value"},model:{value:t.sale.liquidityPercent,callback:function(e){t.$set(t.sale,"liquidityPercent",e)},expression:"sale.liquidityPercent"}})],1)],1)],1)]),t._v(" "),t._m(1),t._v(" "),l("div",{staticClass:"row"},[l("div",{staticClass:"col mt-5"},[l("b-button",{staticClass:"align-self-center",attrs:{disabled:t.sale.metamaskStarted,pressed:t.sale.progress,variant:"info",type:"submit"}},[t._v(t._s(t.sale.progress||"Create")+"\n              ")]),t._v(" "),t.floatFee?l("span",{staticClass:"ml-2 text-muted",staticStyle:{"font-size":"small"}},[t._v(" Fee : "+t._s(t.floatFee)+" "+t._s(t.nativeCurrency))]):t._e()],1)])])])]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4)])])}),[function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"row"},[l("div",{staticClass:"col text-center"},[l("hr",{staticClass:"my-2",staticStyle:{"border-bottom":"2px"}}),t._v(" "),l("div",{staticClass:"h3 text-muted"},[t._v("Start a Token Sale")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-3"})])},function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"row mt-4"},[l("div",{staticClass:"col-3"}),t._v(" "),l("div",{staticClass:"col-6 text-center"})])}],!1,null,"2cba8a47",null);e.default=component.exports}}]);